@startuml
' Abstract class Food
abstract class Food {
  - id : string
  - keywords : vector<string>
  + getCalories() : int
}

' BasicFood derived from Food
class BasicFood {
  - calories : int
  + getCalories() : int
}

' CompositeFood derived from Food
class CompositeFood {
  - components : vector<pair<Food*, int>>
  + getCalories() : int
}

Food <|-- BasicFood
Food <|-- CompositeFood

' FoodDatabase class
class FoodDatabase {
  - foods : vector<Food*>
  + loadFromFile(filename: string) : void
  + saveToFile(filename: string) : void
  + addFood(food: Food*) : void
  + searchFoods(keywords: vector<string>) : vector<Food*>
}

' LogEntry class
class LogEntry {
  - food : Food*
  - servings : int
  + getCalories() : int
}

' DailyLog class with undo functionality
class DailyLog {
  - entries : map<string, vector<LogEntry>>
  - undoStack : stack<LogCommand*>
  + addEntry(date: string, entry: LogEntry) : void
  + deleteEntry(date: string, entryId: int) : void
  + getEntries(date: string) : vector<LogEntry>
  + undoLastCommand() : void
}

' Command Pattern for Undo
interface LogCommand {
  + execute() : void
  + undo() : void
}

class AddFoodCommand {
  - log : DailyLog*
  - date : string
  - entry : LogEntry
  + execute() : void
  + undo() : void
}

class DeleteFoodCommand {
  - log : DailyLog*
  - date : string
  - entry : LogEntry
  + execute() : void
  + undo() : void
}

LogCommand <|.. AddFoodCommand
LogCommand <|.. DeleteFoodCommand

' Undo integration
DailyLog "1" *-- "many" LogCommand
DailyLog --> AddFoodCommand : "Uses"
DailyLog --> DeleteFoodCommand : "Uses"

' UserProfile class
class UserProfile {
  - gender : string
  - height : int
  - age : int
  - weight : double
  - activityLevel : string
  + updateProfile(...) : void
}

' CalorieCalculator interface and its implementations
interface CalorieCalculator {
  + calculateTarget(profile: UserProfile) : int
}

class MethodA_Calculator {
  + calculateTarget(profile: UserProfile) : int
}

class MethodB_Calculator {
  + calculateTarget(profile: UserProfile) : int
}

CalorieCalculator <|.. MethodA_Calculator
CalorieCalculator <|.. MethodB_Calculator
@enduml